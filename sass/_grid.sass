// TODO: Comments!
  
!grid_width ||= 960px
!grid_cols  ||= 16
!grid_gutter_width ||= 20px

=grid-first-cell
  :margin-left 0

=grid-last-cell
  :margin-right 0

=grid-container
  :margin
    :left auto
    :right auto

    // Full margin due to adjacent-margin-collapsing!
    :top= !grid_gutter_width 
    :bottom= !grid_gutter_width
    
  :width= !grid_width


=grid-cell-width(!n, !adjust_by = 0)
  :width= (!grid_width / !grid_cols) * !n - !grid_gutter_width + !adjust_by

=grid-cell-base
  +float-left
  :margin
    :left= !grid_gutter_width / 2
    :right= !grid_gutter_width / 2

=grid-cells(!n, !adjust_by = 0)
  +grid-cell-base
  +grid-cell-width(!n, !adjust_by)
  
=grid-generate-cells
  @for !n from 1 through !grid_cols
    .cells_#{!n}
      +grid-cells(!n)

        
=grid-prefix(!n)
  :padding-left= (!grid_width / !grid_cols) * !n

=grid-generate-prefixes
  @for !n from 1 through !grid_cols - 1          
    .prefix_#{!n}
      +grid-prefix(!n)


=grid-suffix(!n)
  :padding-right= (!grid_width / !grid_cols) * !n

=grid-generate-suffixes
  @for !n from 1 through !grid_cols - 1
    .suffix_#{!n}
      +grid-suffix(!n)
      
=grid(!width = !grid_width, !cols = !grid_cols, !gutter_width = !grid_gutter_width)
  !grid_width = !width
  !grid_cols  = !cols
  !grid_gutter_width = !gutter_width

  +grid-container

  +grid-generate-cells
  +grid-generate-prefixes      
  +grid-generate-suffixes